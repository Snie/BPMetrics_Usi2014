<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-icon-button/core-icon-button.html">
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<link rel="import" href="../bower_components/core-icon-button/core-icon-button.html">

<polymer-element name="side-card" attributes="post show deleted">
<template>
    <style>
        :host {
            display: inline-block;
            position: relative;
            width: 100%;
            height: 30px;
            font-size: 1.2rem;
            font-weight: 300;
        }
        :hover{
            background: #E5E5E5;
        }
       h2 {
            padding-top: 10px;
            margin: 0;
            font-size: 100%;
            font-weight: 300;
        }

        polyfill-next-selector { content: '.card-header h2'; }
        .card-header ::content h2 {
            padding-top: 10px;
            margin: 0;
            font-size: 100%;
            font-weight: 300;
        }
        core-icon-button {
            position: absolute;
            top: 0;
            right: 0;
            padding:2px;
            color: #636363;
        }
        :host([favorite]) core-icon-button {
            color: #da4336;
        }

    </style>


    <core-icon-button id="info" style="display: none;" icon="clear" on-click="{{exterminate}}"></core-icon-button>
    <div on-click="{{onClick}}">
        <div class="card-header" layout horizontal center>
            <content select="h2" ></content>
        </div>
    </div>

</template>


<script>
    Polymer('side-card', {
        deletedChanged: function(oldVal, newVal){
            if(newVal){

                this.hidden = true;
            }
            else this.hidden = false;
        },
        showChanged: function(oldVal, newVal) {
            if(newVal == true) {
                this.$.info.style.display = 'block';
            }
            else{
                this.$.info.style.display = 'none';
            }
        },
        toStringer: function(string){
            return JSON.stringify(string);
        },
        exterminate: function(){
            var xhr = new XMLHttpRequest();
            xhr.open("DELETE", "/models/"+this.post._id, true);
            xhr.send();
            this.deleted = true;
        },
        onClick: function(event, detail,sender){
            if(this.post.models.length <= 1) {
                document.getElementById('list').innerHTML = "<metric-list tipo='ALL' myID='" + this.post.models[0]._id + "'></metric-list>";
            }
            else{
                document.getElementById('list').innerHTML = "<statistic-list tipo='ALL' myID='" + this.post.statistics + "'></statistic-list>";
            }
        }
    });
</script>

</polymer-element>